(this.webpackJsonposmolearn=this.webpackJsonposmolearn||[]).push([[0],{119:function(e,t,n){e.exports={timer:"Timer_timer__R3473"}},131:function(e,t,n){},132:function(e,t,n){},152:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=152},16:function(e,t,n){e.exports={chat:"Chat_chat__2f1FI",messagesContainer:"Chat_messagesContainer__2ijDp",messageInputContainer:"Chat_messageInputContainer__3HIdf",messageInput:"Chat_messageInput__2FsBQ",sendMessageBtn:"Chat_sendMessageBtn__sFt8h",sendIcon:"Chat_sendIcon__1OaQ4",messageContainer:"Chat_messageContainer__1Ekzm",otherMessageContainer:"Chat_otherMessageContainer__3Xdt4",sender:"Chat_sender__2nK1n",message:"Chat_message__ICZ2J",myMessage:"Chat_myMessage__331Zn",otherClientMessage:"Chat_otherClientMessage__3wbWP"}},265:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(114),o=n.n(r),s=(n(131),n(132),n(34)),i=n(5),d=n(3);function u(){return Object(d.jsxs)("div",{children:[Object(d.jsx)(s.b,{to:"/",children:"Home"}),Object(d.jsx)(s.b,{to:"/signin",children:"Sign In"})]})}var l=n(7),b=n(56),j=n.n(b);function m(){var e=Object(i.f)(),t=Object(c.useState)(null),n=Object(l.a)(t,2),a=n[0],r=n[1],o=localStorage.getItem("username");return Object(c.useEffect)((function(){console.log(o),j.a.get("https://osmolearn-dev.herokuapp.com/accounts/".concat(o)).then((function(e){console.log(e.data),r(e.data),localStorage.setItem("isTutor",e.data.isTutor)})).catch((function(e){return console.error(e)}))}),[]),Object(d.jsx)("div",{children:a&&a.upcomingSessions.map((function(t){return Object(d.jsxs)("div",{children:[Object(d.jsxs)("p",{children:["SessionId: ",t.sessionId]}),Object(d.jsx)("button",{onClick:function(n){return e("/session/".concat(t.sessionId))},children:"Join Session"}),Object(d.jsx)("br",{})]},Math.floor(100*Math.random()))}))})}function h(){var e=Object(i.f)();return Object(d.jsx)("div",{children:Object(d.jsxs)("form",{onSubmit:function(t){t.preventDefault();var n=t.target.username.value;localStorage.setItem("username",n),e("/dashboard")},children:[Object(d.jsxs)("label",{children:["Username",Object(d.jsx)("input",{type:"text",name:"username"})]}),Object(d.jsx)("input",{type:"submit",value:"Sign In"})]})})}var f=n(17),O=n(6),g=n.n(O),v=n(59),p=n.n(v),_=n(126),x=n(118),C=n(28),N=n(80),I=n(38),S=n(119),T=n.n(S),k=n(120);function y(){var e=Object(k.useStopwatch)({autoStart:!0}),t=e.seconds,n=e.minutes,c=e.hours;return Object(d.jsx)("div",{className:T.a.timer,children:Object(d.jsxs)("p",{children:[c,":",n,":",t]})})}var M=n(37),w=n(125),R=n(16),E=n.n(R);function B(e){var t=e.clientName,n=e.messages,a=e.myMessage,r=e.setMyMessage,o=e.sendMessage;return Object(c.useEffect)((function(){console.log(n)})),Object(d.jsxs)("div",{className:E.a.chat,children:[Object(d.jsx)("div",{className:E.a.messagesContainer,children:n.map((function(e){return console.log(e),Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("div",{className:e.sender===t?E.a.messageContainer:E.a.otherMessageContainer,children:[Object(d.jsx)("div",{className:E.a.sender,children:e.sender}),Object(d.jsx)("div",{className:e.sender===t?E.a.myMessage:E.a.otherClientMessage,children:Object(d.jsx)("div",{className:E.a.message,children:e.message})},e.message[0]+e.message[e.message.length-1])]})})}))}),Object(d.jsxs)("div",{className:E.a.messageInputContainer,children:[Object(d.jsx)("input",{className:E.a.messageInput,type:"text",placeholder:"Type a message here...",value:a,onChange:function(e){return r(e.target.value)}}),Object(d.jsx)("div",{onClick:o,className:E.a.sendMessageBtn,children:Object(d.jsx)(C.e,{className:E.a.sendIcon,fontSize:25})})]})]})}function F(e){var t=Object(c.useState)(!0),n=Object(l.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)(!1),s=Object(l.a)(o,2),i=s[0],u=s[1],b=Object(c.useState)(!0),m=Object(l.a)(b,2),h=m[0],O=m[1],v=Object(c.useState)(!1),S=Object(l.a)(v,2),T=S[0],k=S[1],R=Object(c.useState)(!1),E=Object(l.a)(R,2),F=E[0],z=E[1],D=Object(c.useState)(!1),V=Object(l.a)(D,2),U=V[0],P=V[1],G=Object(c.useState)([]),A=Object(l.a)(G,2),L=A[0],J=A[1],X=Object(c.useState)(!1),H=Object(l.a)(X,2),Q=H[0],W=H[1],Y=Object(c.useState)(!1),Z=Object(l.a)(Y,2),q=Z[0],K=Z[1],$=Object(c.useState)(!1),ee=Object(l.a)($,2),te=ee[0],ne=ee[1],ce=Object(c.useState)(!1),ae=Object(l.a)(ce,2),re=ae[0],oe=ae[1],se=Object(c.useState)("black"),ie=Object(l.a)(se,2),de=ie[0],ue=ie[1],le=Object(c.useState)([]),be=Object(l.a)(le,2),je=be[0],me=be[1],he=Object(c.useState)(""),fe=Object(l.a)(he,2),Oe=fe[0],ge=fe[1],ve=localStorage.getItem("isTutor"),pe=localStorage.getItem("username"),_e=Object(c.useRef)([]),xe=Object(c.useRef)(),Ce=Object(c.useRef)(null),Ne=Object(c.useRef)(null),Ie=Object(c.useRef)(null),Se=Object(c.useRef)(),Te=Object(c.useRef)({}),ke=Object(c.useRef)(null),ye=Object(c.useRef)(),Me=Object(c.useRef)(),we=Object(c.useRef)();return Object(c.useEffect)((function(){if(window.addEventListener("keydown",(function(e){"Control"!==e.key&&"z"!==e.key&&"x"!==e.key||(Te.current[e.key]=e.key),Object.keys(Te.current).length>=2&&(Te.current.Control&&Te.current.z&&(xe.current.undo(),U?Ce.current.emit("undo",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db"}):J((function(e){return[].concat(Object(f.a)(e),[{eventName:"undo",data:{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db"}}])}))),Te.current.Control&&Te.current.x&&(xe.current.redo(),U?Ce.current.emit("redo",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db"}):J((function(e){return[].concat(Object(f.a)(e),[{eventName:"redo",data:{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db"}}])}))))})),window.addEventListener("keyup",(function(e){Te.current={}})),Ce.current=Object(_.a)(),Ce.current.emit("user connected",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",name:pe}),Ce.current.on("disable other client video",(function(e){console.log("other client stopped their video feed"),ye.current.srcObject?ye.current.srcObject.getVideoTracks().forEach((function(e){return e.enabled=!1})):_e.current.push("video")})),Ce.current.on("enable other client video",(function(e){console.log("other client enabled their video feed"),ye.current.srcObject&&ye.current.srcObject.getVideoTracks().forEach((function(e){return e.enabled=!0}))})),Ce.current.on("disable other client audio",(function(e){console.log("other client stopped their audio feed"),ye.current.srcObject?ye.current.srcObject.getAudioTracks().forEach((function(e){return e.enabled=!1})):_e.current.push("audio")})),Ce.current.on("enable other client audio",(function(e){console.log("other client enabled their audio feed"),ye.current.srcObject&&ye.current.srcObject.getAudioTracks().forEach((function(e){return e.enabled=!0}))})),Ce.current.on("draw",(function(e){xe.current.loadPaths(e)})),Ce.current.on("screenshare",(function(){if(console.log("Getting screenshare data"),!Ie.current){var e=new p.a("".concat(pe,"-video"),{secure:!0,host:"osmolearn-dev.herokuapp.com",port:"3001",path:"/callpeer"});Ie.current=e,e.on("open",(function(t){e.on("call",(function(e){e.answer(null),e.on("stream",(function(e){ne(!0),we.current.srcObject=e,console.log("answered screenshare call and got screenshare data")}))}))}))}})),Ce.current.on("end screenshare",(function(){Ie.current&&(Ie.current.destroy(),Ie.current=null),ne(!1),we.current=null})),Ce.current.on("undo",(function(){xe.current.undo()})),Ce.current.on("redo",(function(){xe.current.redo()})),Ce.current.on("message",(function(e){console.log(e),me((function(t){return[].concat(Object(f.a)(t),[{sender:ke.current,message:e}])}))})),j.a.get("https://osmolearn-dev.herokuapp.com/call/".concat(pe,"/07b799f3-8e4d-4c26-a4bd-d65b80ce83db")).then((function(e){return ke.current=e.data})).catch((function(e){return console.error(e)})),(navigator.mozGetUserMedia||navigator.mediaDevices.mozGetUserMedia||navigator.mediaDevices.getUserMedia||navigator.mediaDevices.webkitGetUserMedia)({video:!0,audio:!0}).then((function(e){Se.current.srcObject=e,Se.current.play()})).catch((function(e){return console.error(e)})),!Ne.current){var e=new p.a(pe,{secure:!0,host:"osmolearn-dev.herokuapp.com",port:"3001",path:"/callpeer"});Ne.current=e,e.on("open",(function(t){console.log("".concat(t," connected")),e.on("call",(function(e){console.log("getting a call"),(navigator.mozGetUserMedia||navigator.mediaDevices.mozGetUserMedia||navigator.mediaDevices.getUserMedia||navigator.mediaDevices.webkitGetUserMedia)({video:!0,audio:!0}).then((function(t){e.answer(t),e.on("stream",(function(e){z(!0),ye.current.srcObject=e,_e.current.includes("video")&&(console.log("latent disabling client video"),ye.current.srcObject.getVideoTracks().forEach((function(e){return e.enabled=!1}))),_e.current.includes("audio")&&(console.log("latent disabling client audio"),ye.current.srcObject.getAudioTracks().forEach((function(e){return e.enabled=!1})))}))})).catch((function(e){return console.error(e)}))}))}))}console.log(Ne.current),Ce.current.on("all clients connected",(function(e){P(!0),W(!0),console.log("all clients connected"),"true"===ve&&(navigator.mozGetUserMedia||navigator.mediaDevices.mozGetUserMedia||navigator.mediaDevices.getUserMedia||navigator.mediaDevices.webkitGetUserMedia)({video:!0,audio:!0}).then((function(e){console.log("calling: ",ke.current),Ne.current.call(ke.current,e).on("stream",(function(e){z(!0),ye.current.srcObject=e}))})).catch((function(e){return console.error(e)}))}))}),[]),Object(c.useEffect)((function(){null===Se.current||a||(Se.current.srcObject.getVideoTracks().forEach((function(e){return e.enabled=!e.enabled})),U?Ce.current.emit("disable video",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",disable:!0}):J((function(e){return[].concat(Object(f.a)(e),[{eventName:"disable video",data:{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",disable:!0}}])})),u(!0)),null!==Se.current&&a&&i&&(Se.current.srcObject.getVideoTracks().forEach((function(e){return e.enabled=!e.enabled})),U?Ce.current.emit("disable video",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",disable:!1}):J((function(e){return[].concat(Object(f.a)(e),[{eventName:"disable video",data:{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",disable:!1}}])})),r(!0),u(!1))}),[a]),Object(c.useEffect)((function(){null===Se.current||h||(U?Ce.current.emit("disable audio",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",disable:!0}):J((function(e){return[].concat(Object(f.a)(e),[{eventName:"disable audio",data:{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",disable:!0}}])})),k(!0)),null!==Se.current&&h&&T&&(U?Ce.current.emit("disable audio",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",disable:!1}):J((function(e){return[].concat(Object(f.a)(e),[{eventName:"disable audio",data:{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",disable:!1}}])})),O(!0),k(!1))}),[h]),Object(c.useEffect)((function(){L.forEach((function(e){Ce.current.emit(e.eventName,e.data)})),J([])}),[U]),Object(d.jsxs)("div",{className:g.a.roomContainer,children:[Object(d.jsxs)("div",{className:g.a.videoFeedsContainer,children:[Object(d.jsxs)("div",{className:g.a.myVideoContainer,children:[Object(d.jsx)("video",{className:g.a.videoFeed,muted:!0,ref:Se}),Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{onClick:function(e){O(!h)},className:g.a.muteButton,children:h?Object(d.jsx)(I.c,{size:30}):Object(d.jsx)(I.d,{size:30})}),Object(d.jsx)("div",{onClick:function(e){r(!a)},className:g.a.stopVideoButton,children:a?Object(d.jsx)(C.b,{size:30}):Object(d.jsx)(C.c,{size:30})}),Object(d.jsx)("div",{onClick:function(e){return U?function(){if(console.log("sharing screen"),q)K(!1),Me.current.srcObject.getTracks().forEach((function(e){return e.stop()})),Ce.current.emit("end screenshare",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db"}),Ie.current&&(Ie.current.destroy(),Ie.current=null),Me.current=null;else{if(!Ie.current){var e=new p.a("".concat(pe,"-video"),{secure:!0,host:"osmolearn-dev.herokuapp.com",port:"3001",path:"/callpeer"});Ie.current=e,e.on("open",(function(t){e.on("call",(function(e){e.answer(null),e.on("stream",(function(e){ne(!0),we.current.srcObject=e,console.log("answered screenshare call and got screenshare data")}))}))})),Ce.current.emit("screenshare",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db"})}navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!0}).then((function(e){e.getVideoTracks()[0].onended=function(){K(!1),Ce.current.emit("end screenshare",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db"}),Ie.current&&(Ie.current.destroy(),Ie.current=null),Me.current=null},Ie.current.call("".concat(ke.current,"-video"),e),console.log("called ".concat(ke.current,"-video")),K(!0),Me.current.srcObject=e})).catch((function(e){return console.error(e)}))}}():alert("Can't share screen until both parties join")},className:g.a.screenShareBtn,children:q?Object(d.jsx)(C.f,{className:g.a.screenShareIcon,fontSize:30}):Object(d.jsx)(C.d,{className:g.a.screenShareIcon,fontSize:30})})]}),Object(d.jsx)("p",{className:g.a.name,children:pe})]}),Object(d.jsxs)("div",{style:{display:F?"block":"none"},className:g.a.otherClientVideoContainer,children:[Object(d.jsx)("video",{className:g.a.videoFeed,autoPlay:!0,ref:ye}),Object(d.jsx)("p",{className:g.a.otherClientName,children:ke.current})]}),q&&Object(d.jsx)("div",{className:g.a.myScreenContainer,children:Object(d.jsx)("video",{className:g.a.videoFeed,autoPlay:!0,ref:Me})}),Q&&Object(d.jsx)("div",{className:g.a.timer,children:Object(d.jsx)(y,{})})]}),Object(d.jsx)("div",{className:g.a.canvas,children:Object(d.jsx)(x.a,{height:window.innerHeight,strokeWidth:5,strokeColor:de,ref:xe,onStroke:function(e){Ce.current&&(U?Ce.current.emit("draw",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",canvasPaths:e}):J((function(t){return[].concat(Object(f.a)(t),[{eventName:"draw",data:{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",canvasPaths:e}}])})))}})}),te&&Object(d.jsx)("div",{className:g.a.otherScreenContainer,children:Object(d.jsx)("video",{className:g.a.otherClientScreenVid,autoPlay:!0,ref:we})}),Object(d.jsxs)("div",{className:g.a.tools,children:[Object(d.jsx)("div",{onClick:function(){xe.current.undo(),U?Ce.current.emit("undo",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db"}):J((function(e){return[].concat(Object(f.a)(e),[{eventName:"undo",data:{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db"}}])}))},"data-delay-show":"500","data-tip":"undo","data-for":"undoTip",className:g.a.tool,children:Object(d.jsx)(N.b,{size:20})}),Object(d.jsx)("div",{onClick:function(){xe.current.redo(),U?Ce.current.emit("redo",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db"}):J((function(e){return[].concat(Object(f.a)(e),[{eventName:"redo",data:{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db"}}])}))},"data-delay-show":"500","data-tip":"redo","data-for":"redoTip",className:g.a.tool,children:Object(d.jsx)(N.a,{size:20})}),Object(d.jsxs)("div",{onClick:function(e){return oe(!re)},className:g.a.tool,children:[Object(d.jsx)(C.a,{"data-delay-show":"500","data-tip":"color","data-for":"colorTip",size:20}),re&&Object(d.jsx)(w.a,{className:g.a.colorPicker,onChange:function(e,t){console.log("color change to:",e.hex),ue(e.hex)},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]})]}),Object(d.jsx)("div",{"data-delay-show":"500","data-tip":"eraser","data-for":"eraserTip",className:g.a.tool,children:Object(d.jsx)(I.b,{size:20})}),Object(d.jsx)("div",{"data-delay-show":"500","data-tip":"pencil","data-for":"pencilTip",className:g.a.tool,children:Object(d.jsx)(I.e,{size:20})}),Object(d.jsx)(M.a,{place:"right",id:"undoTip",children:"Undo"}),Object(d.jsx)(M.a,{place:"right",id:"redoTip",children:"Redo"}),Object(d.jsx)(M.a,{place:"right",id:"colorTip",children:"Change Pen Color"}),Object(d.jsx)(M.a,{place:"right",id:"eraserTip",children:"Eraser"}),Object(d.jsx)(M.a,{place:"right",id:"pencilTip",children:"Pencil"})]}),Object(d.jsx)(B,{clientName:pe,messages:je,myMessage:Oe,setMyMessage:ge,sendMessage:function(){console.log("message:",Oe),me((function(e){return[].concat(Object(f.a)(e),[{sender:pe,message:Oe}])})),U?Ce.current.emit("message",{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",message:Oe}):J((function(e){return[].concat(Object(f.a)(e),[{eventName:"message",data:{sessionId:"07b799f3-8e4d-4c26-a4bd-d65b80ce83db",message:Oe}}])})),ge("")}}),Object(d.jsxs)("div",{className:g.a.chatBtn,children:["Chat \xa0 ",Object(d.jsx)(I.a,{fontSize:20})]})]})}var z=function(){return Object(d.jsx)(s.a,{children:Object(d.jsx)("div",{className:"App",children:Object(d.jsxs)(i.c,{children:[Object(d.jsx)(i.a,{exact:!0,path:"/",element:Object(d.jsx)(u,{})}),Object(d.jsx)(i.a,{path:"/signin",element:Object(d.jsx)(h,{})}),Object(d.jsx)(i.a,{path:"/dashboard",element:Object(d.jsx)(m,{})}),Object(d.jsx)(i.a,{path:"/session/:sessionId",element:Object(d.jsx)(F,{})})]})})})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,269)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),r(e),o(e)}))};o.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(z,{})}),document.getElementById("root")),D()},6:function(e,t,n){e.exports={roomContainer:"TutoringRoom_roomContainer__1tat7",videoFeedsContainer:"TutoringRoom_videoFeedsContainer__38V25",myVideoContainer:"TutoringRoom_myVideoContainer__2kTlM",otherClientVideoContainer:"TutoringRoom_otherClientVideoContainer__3Lv0e",name:"TutoringRoom_name__2jX-_",otherClientName:"TutoringRoom_otherClientName__Bmnvi",videoFeed:"TutoringRoom_videoFeed__3Murp",myScreenContainer:"TutoringRoom_myScreenContainer__3FfD8",stopVideoButton:"TutoringRoom_stopVideoButton__az7wX",muteButton:"TutoringRoom_muteButton__20EBJ",screenShareBtn:"TutoringRoom_screenShareBtn__3GG_v",canvas:"TutoringRoom_canvas__3YLT_",otherScreenContainer:"TutoringRoom_otherScreenContainer__1PAlR",otherClientScreenVid:"TutoringRoom_otherClientScreenVid__1Clbl",tools:"TutoringRoom_tools__30AnB",tool:"TutoringRoom_tool__2j91O",colorPicker:"TutoringRoom_colorPicker__1hsDY",timer:"TutoringRoom_timer__3c7dX",chatBtn:"TutoringRoom_chatBtn__p_Gq8"}}},[[265,1,2]]]);
//# sourceMappingURL=main.4ae57f8b.chunk.js.map